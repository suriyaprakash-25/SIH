<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KMRL Metro Firebase Setup</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            max-width: 800px; 
            margin: 50px auto; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 { 
            color: #2c3e50; 
            text-align: center;
            margin-bottom: 30px;
        }
        button { 
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 8px; 
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
            width: 100%;
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }
        .log { 
            background: #f8f9fa; 
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px; 
            margin: 20px 0;
            height: 300px; 
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .success { color: #27ae60; }
        .error { color: #e74c3c; }
        .warning { color: #f39c12; }
        .info { color: #3498db; }
        .config {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöä KMRL Metro Firebase Setup</h1>
        
        <div class="config">
            <h3>Firebase Configuration (Replace with your config):</h3>
            <pre id="firebaseConfig">
// Replace this with your Firebase config from:
// Firebase Console > Project Settings > General > Your apps
const firebaseConfig = {
    apiKey: "your-api-key",
    authDomain: "sih-logins.firebaseapp.com",
    projectId: "sih-logins",
    storageBucket: "sih-logins.appspot.com",
    messagingSenderId: "your-sender-id",
    appId: "your-app-id"
};
            </pre>
        </div>

        <button onclick="setupFirestore()" id="setupBtn">üöÄ Setup KMRL Firebase Database</button>
        
        <div class="log" id="log"></div>

        <h3>üìã Login Credentials Created:</h3>
        <div class="config">
<pre>Admin: admin@kmrl.com / admin123
Fitness Certificates: fitness@kmrl.com / fitness123
Job Card Status: jobcard@kmrl.com / jobcard123
Branding Priorities: branding@kmrl.com / branding123
Mileage Monitoring: mileage@kmrl.com / mileage123
Cleaning Slots: cleaning@kmrl.com / cleaning123
Stabling Positions: stabling@kmrl.com / stabling123
Cleaning & Maintenance: maintenance@kmrl.com / maintenance123</pre>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
        import { getAuth, createUserWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';
        import { getFirestore, doc, setDoc, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

        // ‚ö†Ô∏è REPLACE THIS WITH YOUR FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "your-api-key-here",
            authDomain: "sih-logins.firebaseapp.com",
            projectId: "sih-logins",
            storageBucket: "sih-logins.appspot.com",
            messagingSenderId: "your-sender-id",
            appId: "your-app-id"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type;
            logDiv.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // Users to create
        const users = [
            { email: 'admin@kmrl.com', password: 'admin123', role: 'Admin', department: 'Administration' },
            { email: 'fitness@kmrl.com', password: 'fitness123', role: 'Fitness Certificates', department: 'Safety & Compliance' },
            { email: 'jobcard@kmrl.com', password: 'jobcard123', role: 'Job Card Status', department: 'Maintenance' },
            { email: 'branding@kmrl.com', password: 'branding123', role: 'Branding Priorities', department: 'Marketing' },
            { email: 'mileage@kmrl.com', password: 'mileage123', role: 'Mileage Monitoring', department: 'Operations' },
            { email: 'cleaning@kmrl.com', password: 'cleaning123', role: 'Cleaning Slots', department: 'Facility Management' },
            { email: 'stabling@kmrl.com', password: 'stabling123', role: 'Stabling Positions', department: 'Depot Management' },
            { email: 'maintenance@kmrl.com', password: 'maintenance123', role: 'Cleaning & Maintenance', department: 'Integrated Services' }
        ];

        window.setupFirestore = async function() {
            const btn = document.getElementById('setupBtn');
            btn.disabled = true;
            btn.textContent = 'üîÑ Setting up...';
            
            try {
                log('üöÄ Starting KMRL Metro Firebase setup...', 'info');
                
                // Create users
                log('üë• Creating authentication users...', 'info');
                for (const userData of users) {
                    try {
                        const userCredential = await createUserWithEmailAndPassword(auth, userData.email, userData.password);
                        const user = userCredential.user;
                        
                        // Create user document
                        await setDoc(doc(db, 'users', user.uid), {
                            email: userData.email,
                            role: userData.role,
                            department: userData.department,
                            permissions: userData.role === 'Admin' ? ['read', 'write', 'admin'] : ['read', 'write'],
                            createdAt: serverTimestamp(),
                            active: true
                        });
                        
                        log(`‚úÖ Created user: ${userData.email} (${userData.role})`, 'success');
                    } catch (error) {
                        if (error.code === 'auth/email-already-exists') {
                            log(`‚ö†Ô∏è User already exists: ${userData.email}`, 'warning');
                        } else {
                            log(`‚ùå Error creating ${userData.email}: ${error.message}`, 'error');
                        }
                    }
                }

                // Create sample data
                log('üìä Creating sample data collections...', 'info');

                // Certificates
                const certificates = [
                    {
                        trainId: 'KMRL-TS-01',
                        carId: 'KMRL-MC-01A',
                        certificateType: 'Safety Fitness',
                        issueDate: new Date('2024-01-15'),
                        expiryDate: new Date('2025-01-15'),
                        status: 'Valid',
                        inspector: 'Inspector Kumar',
                        score: 95
                    },
                    {
                        trainId: 'KMRL-TS-02',
                        carId: 'KMRL-TC-02B',
                        certificateType: 'Electrical Safety',
                        issueDate: new Date('2024-02-10'),
                        expiryDate: new Date('2024-12-25'),
                        status: 'Expiring Soon',
                        inspector: 'Inspector Sharma',
                        score: 88
                    }
                ];

                for (const cert of certificates) {
                    await addDoc(collection(db, 'certificates'), {
                        ...cert,
                        createdAt: serverTimestamp()
                    });
                }
                log(`‚úÖ Created ${certificates.length} certificate records`, 'success');

                // Job Cards
                const jobCards = [
                    {
                        trainId: 'KMRL-TS-01',
                        jobId: 'JC-2024-001',
                        status: 'Open',
                        priority: 'High',
                        details: 'Brake pad replacement required',
                        assignedTo: 'Maintenance Team Alpha',
                        estimatedHours: 4
                    },
                    {
                        trainId: 'KMRL-TS-02',
                        jobId: 'JC-2024-002',
                        status: 'In Progress',
                        priority: 'Medium',
                        details: 'HVAC unit inspection',
                        assignedTo: 'Maintenance Team Beta',
                        estimatedHours: 6
                    }
                ];

                for (const job of jobCards) {
                    await addDoc(collection(db, 'jobCards'), {
                        ...job,
                        createdAt: serverTimestamp()
                    });
                }
                log(`‚úÖ Created ${jobCards.length} job card records`, 'success');

                log('üéâ Firebase setup completed successfully!', 'success');
                log('üîê You can now use the credentials above to login', 'info');
                log('üåê Test at: http://localhost:3000', 'info');
                
            } catch (error) {
                log(`‚ùå Setup failed: ${error.message}`, 'error');
            }
            
            btn.disabled = false;
            btn.textContent = 'üöÄ Setup KMRL Firebase Database';
        };
    </script>
</body>
</html>